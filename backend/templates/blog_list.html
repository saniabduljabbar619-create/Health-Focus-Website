{% extends "base.html" %}
{% block content %}

<!-- ============================
     BLOG HEADER
=============================== -->
<section class="blog-header">
    <h1>Health Articles & Updates</h1>
    <p>Explore medical news, health tips, clinic announcements, and expert insights.</p>
</section>

<!-- ============================
     BLOG CARD GRID
=============================== -->
<section class="blog-grid">

    {% for post in posts %}
    <div class="blog-card fade-in-up">

        <div class="blog-img-box">

            {% if post.type == 'video' %}

                {% if post.video_url %}
                    
                    {# ===== UNIVERSAL YOUTUBE ID EXTRACTOR ===== #}
                    {% if "youtu.be" in post.video_url %}
                        {% set youtube_id = post.video_url.split('/')[-1].split('?')[0] %}
                    {% elif "watch?v=" in post.video_url %}
                        {% set youtube_id = post.video_url.split('v=')[-1].split('&')[0] %}
                    {% elif "/embed/" in post.video_url %}
                        {% set youtube_id = post.video_url.split('/embed/')[-1].split('?')[0] %}
                    {% elif "/shorts/" in post.video_url %}
                        {% set youtube_id = post.video_url.split('/shorts/')[-1].split('?')[0] %}
                    {% else %}
                        {% set youtube_id = "" %}
                    {% endif %}

                    {# ---- SHOW YOUTUBE THUMBNAIL ---- #}
                    <img 
                        src="https://img.youtube.com/vi/{{ youtube_id }}/hqdefault.jpg"
                        class="blog-img">

                {% elif post.video_file %}
                    {# ---- LOCAL VIDEO PLACEHOLDER ---- #}
                    <img src="{{ url_for('static', filename='uploads/video_placeholder.jpg') }}" 
                         class="blog-img">

                {% else %}
                    {# ---- FALLBACK ---- #}
                    <img src="{{ url_for('static', filename='uploads/default.jpg') }}" 
                         class="blog-img">
                {% endif %}

                <div class="video-badge">â–¶ Video</div>

            {% else %}
                {# ---- NORMAL ARTICLE IMAGE ---- #}
                <img src="{{ url_for('static', filename='uploads/' + post.image) }}" 
                     class="blog-img">
            {% endif %}

        </div>

        <div class="blog-body">
            <span class="blog-category">{{ post.category }}</span>
            <h2>{{ post.title }}</h2>
            <p class="blog-excerpt">{{ post.excerpt|safe }}</p>

            <div class="blog-meta">
                <span>{{ post.date }}</span>
            </div>

            <a href="/blog/{{ post.id }}" class="btn blog-btn">Read More</a>
        </div>

    </div>
    {% endfor %}

</section>

{% endblock %}
